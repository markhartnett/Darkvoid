<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
</head>
<body>
    <div id="login">
        <h1>Login</h1>
        <form id="loginForm">
        <label>
            Username:
            <input type="text" id="username"/>
        </label><br/>
        <label>
            Password:
            <input type="text" id="password"/>
        </label><br/>
        <input type="submit"/>
        </form>

        <Button>Back</Button>
        <script type="text/javascript" src="loginFunctions.js"></script>
        <script>
            $(document).ready(function() {
                var studentNum;
                var staffNum;
                var name = "";

                $("form").submit(function (event) {
                    const username = $("#username").val();
                    const password = $("#password").val();

                    $.when(checkStudentLogin(username, password), checkStaffLogin(username, password)).done(function (n1, n2) {
                        studentNum = n1[0];
                        staffNum = n2[0];

                        if (studentNum !== -1 && staffNum === -1) {
                            $.when(getStudent(studentNum)).done(function (data) {
                                name = data.firstName;

                                document.cookie = "name=" + name + "; isStaff=0; path=/";
                            });
                        } else if (staffNum !== -1) {
                            $.when(getStaff(studentNum)).done(function (data) {
                                name = data.firstName;

                                document.cookie = "name=" + name + "; isStaff=1; path=/";
                            });
                        } else {
                            alert("Incorrect Login");
                        }
                    });

                    event.preventDefault();
                });
            });
        </script>
    </div>
</body>
</html>